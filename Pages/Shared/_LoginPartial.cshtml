@using Microsoft.AspNetCore.Identity
@using Hygge.Data

@inject SignInManager<HyggeUser> SignInManager
@inject UserManager<HyggeUser> UserManager


@if (SignInManager.IsSignedIn(User))
{
    
    var currentUser = await UserManager.GetUserAsync(User);
    <div class="navbar-nav ms-auto gap-2 align-items-center justify-content-center d-lg-flex d-none">
        <li class="nav-item ">
            @DateTime.Today.DayOfWeek @DateTime.Today.Year/@DateTime.Today.Month/@DateTime.Today.Day
        </li>
        <li class="nav-item align-items-center justify-content-center d-flex rounded-circle card">
            <i class="fa-regular fa-circle-question item-icon"></i>
        </li>
        <li class="nav-item align-items-center justify-content-center d-flex item-icon rounded-circle card">
            <i class="fa-regular fa-message"></i>
        </li>
        <li class="nav-item align-items-center justify-content-center d-flex item-icon rounded-circle card">
            <i class="fa-solid fa-gear"></i>
        </li>
        <li class="nav-item align-items-center justify-content-center d-flex item-icon rounded-circle card" id="settingMenu">
            <a type="button" ><i class="fa-solid fa-grip btn-setting" ></i></a>
            <dialog class="custorm-menu-modal" id="menuIcon">
                <div class="col">
                    <div class="row">
                        <div class="col">
                            <div class="text-center icon-item p-1">
                                <span class="hygge-worksheet"></span>
                                Worksheet
                            </div>
                        </div>
                        <div class="col">
                            <div class="text-center icon-item">
                                <span class="hygge-search"></span>
                                Search
                            </div>
                        </div>
                        <div class="col">
                            <div class="text-center icon-item p-1">
                                <span class="hygge-manager"></span>
                                Manager
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="text-center icon-item p-1">
                                <span class="hygge-map"></span>
                                Map
                            </div>
                        </div>
                        <div class="col">
                            <div class="text-center icon-item">
                                <span class="hygge-youtube"></span>
                                Youtube
                            </div>
                        </div>
                        <div class="col">
                            <div class="text-center icon-item p-1">
                                <span class="hygge-play"></span>
                                Play
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="text-center icon-item p-1">
                                <span class="hygge-news"></span>
                                News
                            </div>
                        </div>
                        <div class="col">
                            <div class="text-center icon-item">
                                <span class="hygge-mail"></span>
                                Mails
                            </div>
                        </div>
                        <div class="col">
                            <div class="text-center icon-item p-1">
                                <span class="hygge-meet"></span>
                                Meet
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="text-center icon-item p-1">
                                <span class="hygge-chat"></span>
                                Chat
                            </div>
                        </div>
                        <div class="col">
                            <div class="text-center icon-item">
                                <span class="hygge-contact"></span>
                                Contact
                            </div>
                        </div>
                        <div class="col">
                            <div class="text-center icon-item p-1">
                                <span class="hygge-driver"></span>
                                Driver
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="text-center icon-item p-1">
                                <span class="hygge-calendar"></span>
                                Calendar
                            </div>
                        </div>
                        <div class="col">
                            <div class="text-center icon-item">
                                <span class="hygge-translate"></span>
                                Translate
                            </div>
                        </div>
                        <div class="col">
                            <div class="text-center icon-item p-1">
                                <span class="hygge-ar"></span>
                                AR
                            </div>
                        </div>
                    </div>
                </div>
            </dialog>
        </li>
        <li class="nav-item d-flex align-items-center p-1">
            <a type="button" id="avatarImg" >
            @if (currentUser!=null)
            {
                @if (currentUser.AvatarImageUrl != null)
                {
                    <img class="image-avatar" src="@currentUser.AvatarImageUrl" />
                }
                else
                {
                    <img class="image-avatar" src="~/img/avatar/default.jpg" />
                }
                
            }else{
                <img class="image-avatar" src="~/img/avatar/default.jpg" />
            }
            </a>
             <dialog class="custorm-personal-modal" id="personalInfo">
                <div class="row">
                    <span class="col-11 text-center p-0">@UserManager.GetUserName(User)</span>
                    <button type="button" class="btn-close" id="closeInfo" aria-label="Close"></button>
                </div>
                <div class="col-11 d-flex align-items-center flex-column mt-1">
                    <div>
                        <a type="button" id="avatarImg" class="position-relative">
                            @if (currentUser != null)
                            {
                                @if (currentUser.AvatarImageUrl != null)
                                {
                                    <img class="avatar-info" src="@currentUser.AvatarImageUrl" />
                                }
                                else
                                {
                                    <img class="avatar-info" src="~/img/avatar/default.jpg" />
                                }

                            }
                            else
                            {
                                <img class="avatar-info" src="~/img/avatar/default.jpg" />
                            }
                            <i class="position-absolute bottom-0 start-100 fa-solid fa-pen"></i>
                        </a>
                        
                    </div>
                    <div class="text-center d-flex flex-column gap-1 mt-1">
                        <span>
                            Hello  @if (currentUser != null)
                            {
                                @currentUser.Name
                            }
                            </span>
                        <div type="button" class="border border-primary btn-manager p-1">Manage your Account </div>
                    </div>
                    <div class="btn-group btn-personal-group w-100 pt-1" role="group">
                        <div class="btn btn-outline-secondary btn-personal btn-add-account">
                            <a asp-area="Identity" asp-page="/Account/Register" class="text-decoration-none text-dark"><i class="fa-solid fa-plus mr-1"></i>&ensp; Add new account</a>
                        </div>
                        <div class="btn btn-outline-secondary btn-personal btn-logout  ">
                            <form id="logoutForm" asp-area="Identity" asp-page="/Account/Logout" asp-route-returnUrl="@Url.Page("/Index", new { area = "" })">
                                <button id="logout" type="submit" class="p-0 nav-link btn btn-link text-dark border-0 align-items-center "><i class="fa-solid fa-door-open"></i>&ensp; Logout</button>
                            </form>
                        </div>
                    </div>
                </div>
            </dialog>
        </li>
    </div>
}
else
{
   <div class="navbar-nav ms-auto">
        <a class="nav-item">
            <div class="dropdown mx-2 d-none d-lg-block">
                <a class="btn meet-create dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                    <span class="d-lg-inline">Try meet</span>
                </a>
                <ul class="dropdown-menu">
                    <li><span class="dropdown-item">For businesses</span></li>
                    <li><span class="dropdown-item">For Everyone</span></li>
                </ul>
            </div>
        </a>
        <a class="nav-item btn btn-login" type="button" asp-area="Identity" asp-page="/Account/Login">Login</a>
    </div>
}
