@using Microsoft.AspNetCore.Identity
@using Hygge.Data

@inject SignInManager<HyggeUser> SignInManager
@inject UserManager<HyggeUser> UserManager


@if (SignInManager.IsSignedIn(User))
{
    var currentUser = await UserManager.GetUserAsync(User);
    <ul class="navbar-nav ms-auto gap-2 align-items-center justify-content-center d-md-flex d-none">
        <li class="nav-item ">
            @DateTime.Today.DayOfWeek @DateTime.Today.Year/@DateTime.Today.Month/@DateTime.Today.Day
        </li>
        <li class="nav-item align-items-center justify-content-center d-flex rounded-circle card">
            <i class="fa-regular fa-circle-question item-icon"></i>
        </li>
        <li class="nav-item align-items-center justify-content-center d-flex item-icon rounded-circle card">
            <i class="fa-regular fa-message"></i>
        </li>
        <li class="nav-item align-items-center justify-content-center d-flex item-icon rounded-circle card" >
            <div class="" type="button" data-bs-toggle="modal" data-bs-target="#settingModal">
                <i class="fa-solid fa-gear"></i>
            </div>
            <!-- Modal -->
            <div class="modal fade" id="settingModal" tabindex="-1" aria-labelledby="settingLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered setting-modal " role="document">
                    <div class="modal-content ">
                        <div class="modal-header py-1">
                            <h2>Setting</h2>
                            <div style="float:right"><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div>
                        </div>
                        <div class="modal-body p-0">
                            <div class="d-flex flex-column">
                                <div class="row">
                                    <div class="col-md-3 setting-menu">
                                        <div class="nav nav-pills flex-column" id="settingList" role="tablist" aria-orientation="vertical">
                                            <a class="setting-item nav-link active" data-bs-toggle="pill" href="#volume" role="tab" aria-controls="volume" aria-selected="true">
                                                <i class="fas fa-headphones-alt"></i>
                                                <span>Volume</span>
                                            </a>
                                            <a class="setting-item nav-link" data-bs-toggle="pill" href="#video" role="tab" aria-controls="video" aria-selected="false">
                                                <i class="fas fa-video"></i>
                                                <span>Video</span>
                                            </a>
                                            <a class="setting-item nav-link" data-bs-toggle="pill" href="#generalSetting" role="tab" aria-controls="generalSetting" aria-selected="false">
                                                <i class="fa-solid fa-gear"></i>
                                                <span>General</span>
                                            </a>
                                        </div>
                                    </div>
                                    <div class="col-md-9">
                                        <div class="tab-content">
                                            <div class="tab-pane fade pb-5 show active" id="volume" role="tabpanel" aria-labelledby="volume">
                                                <div class="mt-2 d-flex flex-column">
                                                    <span style="color:#1A73E8;  line-height: 20px">Micro</span>
                                                    <div style=" align-items: flex-start; display: inline-flex">
                                                        <div class="setting-edit-item">
                                                            <select class="form-select form-select-lg">
                                                                <option selected>Open this select menu</option>
                                                                <option value="1">Microphone (2- USB Audio Device)</option>
                                                                <option value="2">Microphone (2- USB Audio Device)</option>
                                                                <option value="3">Microphone (2- USB Audio Device)</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="mt-2 d-flex flex-column">
                                                    <span style="color:#1A73E8;  line-height: 20px">Loudspeaker</span>
                                                    <div style=" align-items: flex-start; display: inline-flex">
                                                        <div class="setting-edit-item">
                                                            <select class="form-select form-select-lg">
                                                                <option selected>Open this select menu</option>
                                                                <option value="1">Microphone (2- USB Audio Device)</option>
                                                                <option value="2">Microphone (2- USB Audio Device)</option>
                                                                <option value="3">Microphone (2- USB Audio Device)</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div id="video" class="tab-pane fade" role="tabpanel" aria-labelledby="video">
                                                <div class="mt-2 d-flex flex-column">
                                                    <span style="color:#1A73E8;  line-height: 20px">Camera</span>
                                                    <div style=" align-items: flex-start; display: inline-flex">
                                                        <div class="setting-edit-item">
                                                            <select class="form-select form-select-lg">
                                                                <option selected>Open this select menu</option>
                                                                <option value="1">Microphone (2- USB Audio Device)</option>
                                                                <option value="2">Microphone (2- USB Audio Device)</option>
                                                                <option value="3">Microphone (2- USB Audio Device)</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div id="generalSetting" class="tab-pane fade" role="tabpanel" aria-labelledby="generalSetting">
                                                <div class="col pt-2">
                                                    <div class="row">
                                                        <div class="col-8">
                                                            <b>Send additional diagnostic information to Hygge</b><br />
                                                            Hygge uses these syslogs to improve Meet for everyone
                                                        </div>
                                                        <div class="col-4">
                                                            <div class="form-check form-switch">
                                                                <input class="form-check-input" type="checkbox"  id="isDiagnostic" checked>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-8">
                                                            <b>Leave the call without anyone participating</b><br />
                                                            Removes you from the call after a few minutes if no one else is participating
                                                        </div>
                                                        <div class="col-4">
                                                            <div class="form-check form-switch">
                                                                <input class="form-check-input" type="checkbox" id="isLeaveIfNoOne" checked>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                               
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                       
                    </div>
                </div>
            </div>
        </li>
        <li class="nav-item align-items-center justify-content-center d-flex item-icon rounded-circle card" id="settingMenu">
            <a type="button" ><i class="fa-solid fa-grip btn-setting" ></i></a>
            <dialog class="custorm-menu-modal" id="menuIcon">
                <div class="col">
                    <div class="row">
                        <div class="col">
                            <div class="text-center icon-item p-1">
                                <span class="hygge-worksheet"></span>
                                Worksheet
                            </div>
                        </div>
                        <div class="col">
                            <div class="text-center icon-item">
                                <span class="hygge-search"></span>
                                Search
                            </div>
                        </div>
                        <div class="col">
                            <div class="text-center icon-item p-1">
                                <span class="hygge-manager"></span>
                                Manager
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="text-center icon-item p-1">
                                <span class="hygge-map"></span>
                                Map
                            </div>
                        </div>
                        <div class="col">
                            <div class="text-center icon-item">
                                <span class="hygge-youtube"></span>
                                Youtube
                            </div>
                        </div>
                        <div class="col">
                            <div class="text-center icon-item p-1">
                                <span class="hygge-play"></span>
                                Play
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="text-center icon-item p-1">
                                <span class="hygge-news"></span>
                                News
                            </div>
                        </div>
                        <div class="col">
                            <div class="text-center icon-item">
                                <span class="hygge-mail"></span>
                                Mails
                            </div>
                        </div>
                        <div class="col">
                            <div class="text-center icon-item p-1">
                                <span class="hygge-meet"></span>
                                Meet
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="text-center icon-item p-1">
                                <span class="hygge-chat"></span>
                                Chat
                            </div>
                        </div>
                        <div class="col">
                            <div class="text-center icon-item">
                                <span class="hygge-contact"></span>
                                Contact
                            </div>
                        </div>
                        <div class="col">
                            <div class="text-center icon-item p-1">
                                <span class="hygge-driver"></span>
                                Driver
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="text-center icon-item p-1">
                                <span class="hygge-calendar"></span>
                                Calendar
                            </div>
                        </div>
                        <div class="col">
                            <div class="text-center icon-item">
                                <span class="hygge-translate"></span>
                                Translate
                            </div>
                        </div>
                        <div class="col">
                            <div class="text-center icon-item p-1">
                                <span class="hygge-ar"></span>
                                AR
                            </div>
                        </div>
                    </div>
                </div>
            </dialog>
        </li>
        <li class="nav-item d-flex align-items-center p-1">
            <a type="button" id="avatarImg" >
            @if (currentUser!=null)
            {
                @if (currentUser.AvatarImageUrl != null)
                {
                    <img class="image-avatar" src="@currentUser.AvatarImageUrl" />
                }
                else
                {
                    <img class="image-avatar" src="~/img/avatar/default.jpg" />
                }
                
            }else{
                <img class="image-avatar" src="~/img/avatar/default.jpg" />
            }
            </a>
             <dialog class="custorm-personal-modal" id="personalInfo">
                <div class="row">
                    <span class="col-11 text-center p-0">@UserManager.GetUserName(User)</span>
                    <button type="button" class="btn-close" id="closeInfo" aria-label="Close"></button>
                </div>
                <div class="col-11 d-flex align-items-center flex-column mt-1">
                    <div>
                        <a type="button" id="avatarImg" class="position-relative">
                            @if (currentUser != null)
                            {
                                @if (currentUser.AvatarImageUrl != null)
                                {
                                    <img class="avatar-info" src="@currentUser.AvatarImageUrl" />
                                }
                                else
                                {
                                    <img class="avatar-info" src="~/img/avatar/default.jpg" />
                                }

                            }
                            else
                            {
                                <img class="avatar-info" src="~/img/avatar/default.jpg" />
                            }
                            <i class="position-absolute bottom-0 start-100 fa-solid fa-pen"></i>
                        </a>
                        
                    </div>
                    <div class="text-center d-flex flex-column gap-1 mt-1">
                        <span>
                            Hello  @if (currentUser != null)
                            {
                                @currentUser.Name
                            }
                            </span>
                        <div type="button" class="border border-primary btn-manager p-1">Manage your Account </div>
                    </div>
                    <div class="btn-group btn-personal-group w-100 pt-1" role="group">
                        <div class="btn btn-outline-secondary btn-personal btn-add-account">
                            <a asp-area="Identity" asp-page="/Account/Register" class="text-decoration-none text-dark"><i class="fa-solid fa-plus mr-1"></i>&ensp; Add new account</a>
                        </div>
                        <div class="btn btn-outline-secondary btn-personal btn-logout  ">
                            <form id="logoutForm" asp-area="Identity" asp-page="/Account/Logout" asp-route-returnUrl="@Url.Page("/Index", new { area = "" })">
                                <button id="logout" type="submit" class="p-0 nav-link btn btn-link text-dark border-0 align-items-center "><i class="fa-solid fa-door-open"></i>&ensp; Logout</button>
                            </form>
                        </div>
                    </div>
                </div>
            </dialog>
        </li>
    </ul>
}
else
{
   <div class="navbar-nav ms-auto">
        <a class="nav-item">
            <div class="dropdown mx-2 d-none d-lg-block">
                <a class="btn meet-create dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                    <span class="d-lg-inline">Try meet</span>
                </a>
                <ul class="dropdown-menu">
                    <li><span class="dropdown-item">For businesses</span></li>
                    <li><span class="dropdown-item">For Everyone</span></li>
                </ul>
            </div>
        </a>
        <a class="nav-item btn btn-login" type="button" asp-area="Identity" asp-page="/Account/Login">Login</a>
    </div>
}
